{"version":3,"sources":["webpack:///./src/pages/admin/views/Permission.vue?91b2","webpack:///src/pages/admin/views/Permission.vue","webpack:///./src/pages/admin/views/Permission.vue?4d95","webpack:///./src/pages/admin/views/Permission.vue"],"names":["render","_vm","this","_h","$createElement","_c","_self","attrs","userList","scopedSlots","_u","key","fn","scope","staticStyle","row","avatar","approved","on","$event","switchApproved","switchAdmin","model","value","callback","$$v","$set","expression","rejectedUser","_v","userTotalNum","searchUserParams","limit","handleUserCurrentChange","staticRenderFns","name","data","created","methods","component"],"mappings":"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","file":"js/chunk-2d226c7f.737874f0.js","sourcesContent":["var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',[_c('el-table',{attrs:{\"data\":_vm.userList}},[_c('el-table-column',{attrs:{\"label\":\"用户名\",\"prop\":\"userName\"}}),_c('el-table-column',{attrs:{\"label\":\"头像\"},scopedSlots:_vm._u([{key:\"default\",fn:function(scope){return [_c('el-image',{staticStyle:{\"width\":\"100px\"},attrs:{\"src\":scope.row.avatar,\"fit\":\"fill\"}})]}}])}),_c('el-table-column',{attrs:{\"label\":\"简介\",\"prop\":\"description\"}}),_c('el-table-column',{attrs:{\"label\":\"是否冻结账号\"},scopedSlots:_vm._u([{key:\"default\",fn:function(scope){return [_c('el-switch',{attrs:{\"value\":!scope.row.approved},on:{\"change\":function($event){return _vm.switchApproved(scope.row)}}})]}}])}),_c('el-table-column',{attrs:{\"label\":\"是否为管理员\"},scopedSlots:_vm._u([{key:\"default\",fn:function(scope){return [_c('el-switch',{on:{\"change\":function($event){return _vm.switchAdmin(scope.row)}},model:{value:(scope.row.isAdmin),callback:function ($$v) {_vm.$set(scope.row, \"isAdmin\", $$v)},expression:\"scope.row.isAdmin\"}})]}}])}),_c('el-table-column',{attrs:{\"label\":\"操作\"},scopedSlots:_vm._u([{key:\"default\",fn:function(scope){return [_c('el-button',{attrs:{\"type\":\"danger\"},on:{\"click\":function($event){return _vm.rejectedUser(scope.row)}}},[_vm._v(\"删除\")])]}}])})],1),_c('div',[_c('el-pagination',{attrs:{\"layout\":\"prev,pager,next\",\"total\":_vm.userTotalNum,\"page-size\":_vm.searchUserParams.limit},on:{\"current-change\":_vm.handleUserCurrentChange}})],1)],1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\r\n  <div>\r\n    <el-table :data=\"userList\">\r\n        <el-table-column\r\n          label=\"用户名\"\r\n          prop=\"userName\"\r\n        ></el-table-column>\r\n        <el-table-column\r\n          label=\"头像\"\r\n        >\r\n          <template slot-scope=\"scope\">\r\n              <el-image \r\n                :src=\"scope.row.avatar\"\r\n                fit=\"fill\"\r\n                style=\"width: 100px;\"\r\n              ></el-image>\r\n          </template>\r\n        </el-table-column>\r\n        <el-table-column\r\n          label=\"简介\"\r\n          prop=\"description\"\r\n        ></el-table-column>\r\n        <el-table-column\r\n          label=\"是否冻结账号\"\r\n        >\r\n          <template slot-scope=\"scope\">\r\n              <el-switch \r\n                :value=\"!scope.row.approved\" \r\n                @change=\"switchApproved(scope.row)\"\r\n              ></el-switch>\r\n          </template>\r\n        </el-table-column>\r\n        <el-table-column\r\n          label=\"是否为管理员\"\r\n        >\r\n          <template slot-scope=\"scope\">\r\n            <el-switch \r\n                v-model=\"scope.row.isAdmin\" \r\n                @change=\"switchAdmin(scope.row)\"\r\n            ></el-switch>\r\n          </template>\r\n        </el-table-column>\r\n        <el-table-column\r\n          label=\"操作\"\r\n        >\r\n          <template slot-scope=\"scope\">\r\n            <el-button type=\"danger\" @click=\"rejectedUser(scope.row)\">删除</el-button>\r\n          </template>\r\n        </el-table-column>\r\n    </el-table>\r\n    <div>\r\n        <el-pagination\r\n          layout=\"prev,pager,next\"\r\n          :total=\"userTotalNum\"\r\n          :page-size=\"searchUserParams.limit\"\r\n          @current-change=\"handleUserCurrentChange\"\r\n        ></el-pagination>\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport AuthorService from \"@/service/AuthorService\"\r\nexport default {\r\n  name: \"DBManager\",\r\n  data() {\r\n    return {\r\n      searchUserParams:{\r\n          limit:10,\r\n          offset:0\r\n      },\r\n      userList:[],\r\n      userTotalNum:0,\r\n    };\r\n  },\r\n  created(){\r\n      this.getUserList()\r\n  },\r\n  methods:{\r\n      getUserList(){\r\n          AuthorService.getAllUser(this.searchUserParams).then(rs=>{\r\n              this.userList=rs.data.data.userList;\r\n              this.userTotalNum=rs.data.data.userTotalNum;\r\n          })\r\n      },\r\n      rejectedUser(userData){\r\n          AuthorService.deleteUser({\r\n              key:userData.key\r\n          }).then(rs=>{\r\n              console.log(rs)\r\n              if(rs.data.status===200){\r\n                  this.getUserList()\r\n              }\r\n          })\r\n      },\r\n      handleUserCurrentChange(page){\r\n          this.searchUserParams.offset=(page-1)*this.searchUserParams.limit;\r\n          this.getUserList()\r\n      },\r\n      switchAdmin(userData){\r\n          this.$confirm(\"此操作将改变此用户的权限, 后续影响极大, 请问是否继续?\",\"警告\",{\r\n              confirmButtonText:\"我心已决\",\r\n              cancelButtonText:\"取消\",\r\n              type:\"warning\"\r\n          }).then(()=>{\r\n                if(userData.isAdmin){\r\n                    AuthorService.setAdmin({\r\n                      key:userData.key\r\n                    }).then(rs=>{\r\n                        if(rs.data.status===200){\r\n                            this.$message.success(\"已为该用户开启管理员权限\")\r\n                        }\r\n                    })\r\n                }else{\r\n                    AuthorService.unsetAdmin({\r\n                      key:userData.key\r\n                    }).then(rs=>{\r\n                        if(rs.data.status===200){\r\n                            this.$message.success(\"已关闭该用户已管理员权限\")\r\n                        }\r\n                    })\r\n                }\r\n          }).catch(()=>{\r\n              userData.isAdmin=false\r\n              this.$message({\r\n                type: 'info',\r\n                message: '取消操作'\r\n             })\r\n          })\r\n          \r\n      },\r\n      switchApproved(userData){\r\n            this.$confirm(\"此操作将改变此用户的权限, 后续影响极大, 请问是否继续?\",\"警告\",{\r\n              confirmButtonText:\"我心已决\",\r\n              cancelButtonText:\"取消\",\r\n              type: 'warning'\r\n          }).then(()=>{\r\n                if(userData.approved){\r\n                  AuthorService.unApprovedUser({\r\n                    key:userData.key\r\n                  }).then(rs=>{\r\n                    if(rs.data.status===200){\r\n                        userData.approved=!userData.approved;  \r\n                        this.$message.success(\"已冻结该用户\")\r\n                      }\r\n                  })\r\n                }else{\r\n                  AuthorService.approvedUser({\r\n                    key:userData.key\r\n                  }).then(rs=>{\r\n                        if(rs.data.status===200){\r\n                          userData.approved=!userData.approved;  \r\n                          this.$message.success(\"已解冻结该用户\")\r\n                      }\r\n                  })\r\n                }             \r\n            }).catch(()=>{\r\n                this.$message({\r\n                type: 'info',\r\n                     message: '取消操作'\r\n                })\r\n            })    \r\n        }\r\n    }\r\n};\r\n</script>\r\n\r\n<style>\r\n</style>","import mod from \"-!../../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../../node_modules/thread-loader/dist/cjs.js!../../../../node_modules/babel-loader/lib/index.js!../../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Permission.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../../node_modules/thread-loader/dist/cjs.js!../../../../node_modules/babel-loader/lib/index.js!../../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Permission.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./Permission.vue?vue&type=template&id=5e4d74b8&\"\nimport script from \"./Permission.vue?vue&type=script&lang=js&\"\nexport * from \"./Permission.vue?vue&type=script&lang=js&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports"],"sourceRoot":""}